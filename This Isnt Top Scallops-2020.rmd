---
title: "This Isn't Top Scallops, 2020 Edition!"
date: "Last Updated: `r format(Sys.time(), '%B %d, %Y')`"
output: 
  html_document:
    toc: true
    toc_depth: 3
    toc_float: true
    toc_collapsed: false
    theme: cosmo
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, cache = TRUE, dev="png")

setwd(here::here())
options(scipen=999)

library(knitr)
library(kableExtra)
library(emo)
library(png)
library(rlang)
library(tidyverse)
library(magick)
```

```{css, echo = FALSE}
.emoji {
  font-size: 325%;
  vertical-align: middle;
}

.emoji2 {
  font-size: 225%;
  vertical-align: middle;
}

.shrug {
  font-size: 400%;
  vertical-align: middle;
}
```

```{r}
contestants <- c("Eric Adjepong",
                 "Karen Akunowicz",
                 "Jennifer Carroll",
                 "Stephanie Cmar",
                 "Lisa Fernandes",
                 "Kevin Gillespie",
                 "Gregory Gourdet",
                 "Melissa King",
                 "Jamie Lynch",
                 "Brian Malarkey",
                 "Nini Nguyen",
                 "Joe Sasto",
                 "Angelo Sosa",
                 "Bryan Voltaggio",
                 "Lee Anne Wong")

preds_long <- read_csv("This Isn't Top Scallops - 2020 - Draft.csv") %>% 
  .[1:15,] %>% 
  dplyr::select(-1) %>% 
  mutate('Predicted \nFinish' = as.numeric(case_when(.$`Predicted \nFinish` == "1st place" ~ "1",
                                          .$`Predicted \nFinish` == "Last place" ~ "15",
                                          TRUE ~ .$`Predicted \nFinish`))) %>% 
  rename_at(.vars = vars(contains(" \n")),
            .funs = funs(sub(" \n", " ", .))) %>% 
  rename_at(.vars = vars(contains("\n")),
            .funs = funs(sub("\n", " ", .))) %>% 
  gather(key = "Team",
         value = "Cheftestant",
         2:25) %>% 
  group_by(Team) %>% 
  mutate("Predicted Finish" = row_number()) %>% 
  ungroup() %>% 
  mutate(Members = str_extract(Team,
                               '\\([^\\(]*$') %>% 
           str_remove_all(., "\\(|\\)"),
         Members = ifelse(is.na(Members), "Jackson Fratesi", Members),
         Team = str_remove_all(Team,
                               " \\([^\\(]*$")) %>% 
  dplyr::select(Team, Members, "Predicted Finish", Cheftestant)

preds_wide <- preds_long %>% 
  spread(key = "Predicted Finish",
         value = Cheftestant) %>% 
  rename("First Place" = "1",
         "Last Place" = "15")

pics <- list.files(path = "Pics",
                   full.names = TRUE,
                   pattern="*.png")

angelo <- pics[1]
brian <- pics[2]
bryan <- pics[3]
eric <- pics[4]
gregory <- pics[5]
jamie <- pics[6]
jen <- pics[7]
joe <- pics[8]
karen <- pics[9]
kevin <- pics[10]
lee_anne <- pics[11]
lisa <- pics[12]
melissa <- pics[13]
nini <- pics[14]
stephanie <- pics[15]

headshotsize <- 200
dishsize <- "600px"
highlightsize <- "400px"

eliminated <- c()

find_weekly_episode_score <- function(){
  
  preds_long %>% 
  mutate("Week Points" = case_when(Cheftestant %in% week_winners$QFwinner & 
                                       .$`Predicted Finish` <= 8 ~ (10 - .$`Predicted Finish`) * 2,
                                     Cheftestant %in% week_winners$EMwinner & 
                                       .$`Predicted Finish` <= 8 ~ (15 - .$`Predicted Finish`) * 2,
                                     Cheftestant %in% c(week_winners$QFHM, week_winners$EMHM) & 
                                       .$`Predicted Finish` <= 8 ~ 10 - .$`Predicted Finish`,
                                     TRUE ~ 0)) %>% 
  dplyr::group_by(Team, Members) %>% 
  dplyr::summarise(!!week_point_title := sum(`Week Points`)) %>%
  ungroup()
  
}



add_image <- function(filepath, size){
  image_read(filepath) %>% 
    image_scale(str_extract(size, "[0-9]+"))
}
```

Welcome to This Isn't Top Scallops, a Top Chef fantasy league! This page will be home to the league's rules, draft summary, episode-by-episode recaps, _advanced_ metrics, and assorted memes.

Special credit to Janet for assisting with creating the rules and visualizations!

# Week 1 Recap

```{r, Week 1 Summary}
#### update these
eliminated <- c(eliminated, "Joe Sasto")
QFwinner <- c()
QFHM <- c("Melissa King", "Joe Sasto", "Jamie Lynch", "Kevin Gillespie", "Bryan Voltaggio")
EMwinner <- c("Gregory Gourdet")
EMHM <- c("Melissa King", "Jennifer Carroll", "Stephanie Cmar", "Jamie Lynch")
week <- 1
####


week_point_title <- paste("Week", week, "Points") 
week_winners <- list(QFwinner = QFwinner, 
                     QFHM = QFHM, 
                     EMwinner = EMwinner, 
                     EMHM = EMHM)

weekly_episode_score <- find_weekly_episode_score() %>% 
  mutate("Total Episode Points" = `Week 1 Points`) %>% 
  arrange(desc(`Total Episode Points`)) 

Final_points_lost <- preds_long %>% 
  mutate("Final Ranking Points Lost" = ifelse(Cheftestant %in% eliminated,
                                              abs(16 - match(Cheftestant, eliminated) - `Predicted Finish`),
                                              0)) %>% 
  group_by(Team, Members) %>% 
  dplyr::summarise("Final Ranking Points Lost"= sum(`Final Ranking Points Lost`)) %>%
  ungroup() %>% 
  arrange(`Final Ranking Points Lost`)

current_rankings <- left_join(weekly_episode_score %>% 
                                dplyr::select(Team, Members, `Total Episode Points`),
                              Final_points_lost,
                              by = c("Team", "Members")) %>% 
  mutate("Scaled Episode Points" = ((`Total Episode Points` - min(`Total Episode Points`)) / 
           (max(`Total Episode Points`) - min(`Total Episode Points`))) %>% round(2),
         "Scaled Final Ranking Points" = 1 - ((`Final Ranking Points Lost` - min(`Final Ranking Points Lost`)) /
                                                 (max(`Final Ranking Points Lost`) - min(`Final Ranking Points Lost`))) %>% round(2),
         "Projected Final Score" = ((`Scaled Episode Points` + `Scaled Final Ranking Points`) / 2) %>% round(2)) %>% 
  arrange(desc(`Projected Final Score`)) %>% 
  mutate("Current Standing" = row_number()) %>% 
  dplyr::select(`Current Standing`, Team, Members, `Projected Final Score`, everything())
current_rankings$`Current Standing` <- sapply(current_rankings$`Current Standing`, toOrdinal::toOrdinal)
```

It's great to be back! This was a very exciting first episode that saw the all-stars compete in a mise en place relay Quickfire outside Griffith Observatory and a fire-only Elimination Challenge on the beach. Some of the contestants came out of the gate running (**Gregory**, **Melissa**), while others looked rusty in their first challenges back (**Lee Anne**, **Kevin**).

Special shout-out to **Bryan Voltaggio's** elimination challenge dish, which takes the "I guess you need to taste it IRL because it really looks terrible and that's the fundamental flaw with cooking shows on TV" prize of the week.

```{r, out.width = dishsize}
add_image("https://i.imgur.com/QDqQI6L.png", dishsize)
```

Here is this week's recap of winners, losers, and our standings so far.

### Current Standings

After 1 week, here are the current standings. This counts everyone's earned Episode Scores and projects Ranking Scores based on who's been eliminated.


```{r}
current_rankings %>%
  kable(format = "html", escape = FALSE, align = "l") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "responsive"),
                fixed_thead = TRUE,
                font_size = 12,
                position = "left",
                full_width = TRUE) %>%
  column_spec(1:4,
              bold = TRUE,
              color = "black",
              background = "lightgray",
              width = "20em") %>%
  column_spec(4,
              border_right = TRUE) %>%
  scroll_box(height = "700px")
```


### Quickfire

The red team won with two dishes: a delicious char-grilled artichoke with tahini and a chewy-but-tasty-looking artichoke tortellono. 

**Winner:** No one winner was announced.

[`r ji("fire")`]{.emoji} [`r ji("trophy")`]{.emoji}

[`r ji("person_shrugging_medium_light_skin_tone")`]{.shrug}

**Honorable Mentions:** Melissa, Joe, Jamie, Kevin, and Bryan

[`r ji("fire")`]{.emoji} [`r ji("2nd_place_medal")`]{.emoji}

`r include_graphics(c(melissa, joe, jamie, kevin, bryan), dpi = headshotsize)`

**Winning Dishes**

```{r, out.width = dishsize, dpi = 36}
add_image("https://i.imgur.com/obWcFmP.png", dishsize)
```

```{r, out.width = dishsize, dpi = 36}
add_image("https://i.imgur.com/Kvgec6j.png", dishsize)
```

### Elimination Challenge

**Winner:** Gregory!

[`r ji("chef")`]{.emoji} [`r ji("trophy")`]{.emoji}

`r include_graphics(c(gregory), dpi = headshotsize)`

**Honorable Mentions:** Stephanie and Jamie on the winning team. Melissa and Jen also got special shout-outs from the judges.

[`r ji("chef")`]{.emoji} [`r ji("2nd_place_medal")`]{.emoji}

`r include_graphics(c(stephanie, jamie, melissa, jen), dpi = headshotsize)`

**Eliminated:**

[`r ji("skull_and_crossbones")`]{.emoji}

`r include_graphics(c(joe), dpi = headshotsize)`

**Winning Dishes**

```{r, out.width = dishsize, dpi = 36}
add_image("https://i.imgur.com/BacCbVa.png", dishsize)
```

```{r, out.width = dishsize, dpi = 36}
add_image("https://i.imgur.com/m35QsR9.png", dishsize)
```

```{r, out.width = dishsize, dpi = 36}
add_image("https://i.imgur.com/BatQziR.png", dishsize)
```

**Losing Dish**

```{r, out.width = dishsize, dpi = 36}
add_image("https://i.imgur.com/6WNSQsK.png", dishsize)
```

### Episode Score

The top 3 scorers in points for this episode are **`r arrange(weekly_episode_score, desc(weekly_episode_score$"Week 1 Points")) %>% slice(1) %>% pull(Team)`**, **`r arrange(weekly_episode_score, desc(weekly_episode_score$"Week 1 Points")) %>% slice(2) %>% pull(Team)`**, and **`r arrange(weekly_episode_score, desc(weekly_episode_score$"Week 1 Points")) %>% slice(3) %>% pull(Team)`**.

Here are the overall standings in Episode Score after the first episode.

```{r, fig.height = 6}
ggplot(weekly_episode_score,
       aes(x = reorder(Team, weekly_episode_score$"Total Episode Points"),
           y = weekly_episode_score$`Total Episode Points`)) +
  geom_bar(stat = "identity",
           position = "dodge",
           aes(fill = Team)) +
  scale_fill_discrete(guide = FALSE) +
  scale_x_discrete(labels = function(x) str_wrap(x, width = 30)) +
  coord_flip() +
  theme_bw() +
  labs(x = "Team",
       y = "Total Episode Points",
       title = paste("Overall Episode Score Standings After Week", week),
       subtitle = "A higher score is better!")
```

### Ranking Score

We won't know the final Ranking Scores until the season is over, but we can get a sense of how people are doing based on where they ranked contestants that have already been eliminated (notwithstanding possible Last Chance Kitchen comebacks).

Incredibly, Elsa, who has never seen Top Chef, but admittedly loves gambling, is the only one to have guessed this week's loser. She leads in this category.

`r include_graphics("Misc/Elsa_text.jpeg", dpi = headshotsize)`

Here's where things stand currently.

```{r, fig.height = 6}
ggplot(Final_points_lost,
       aes(x = reorder(Team, -Final_points_lost$"Final Ranking Points Lost"),
           y = Final_points_lost$`Final Ranking Points Lost`)) +
  geom_bar(stat = "identity",
           position = "dodge",
           aes(fill = Team)) +
  scale_fill_discrete(guide = FALSE) +
  scale_x_discrete(labels = function(x) str_wrap(x, width = 30)) +
  coord_flip() +
  theme_bw() +
  labs(x = "Team",
       y = "Total Points",
       title = paste("Total Final Ranking Points Lost as of Week", week),
       subtitle = "A lower number is better!")
```

### Team Breakdowns

Lastly, here's a look at how everyone's team is doing after Week 1.

```{r}
preds_wide %>% 
  mutate_if(is.character,
            function(x) {
              cell_spec(x,
                        format = "html",
                        color = ifelse(x %in% eliminated, "red", ""),
                        strikeout = ifelse(x %in% eliminated, TRUE, FALSE))
            }) %>% 
  kable(format = "html", escape = FALSE) %>% 
  kable_styling(bootstrap_options = c("striped", "hover", "responsive"),
                font_size = 12,
                fixed_thead = TRUE,) %>% 
  column_spec(1, bold = TRUE, 
              width = "10em; display: inline-block;") %>% 
  column_spec(2, border_right = TRUE, width = "20em") %>% 
  scroll_box(width = "100%",
             height = "700px")

```

# Week 2 Recap

This week's recap is a guest post from my roommate, **Janet!**, who graciously agreed to write this summary after I whined "No! I don't want to!" She also happens to be from LA and rolled her eyes when they called Hollywood a "neighborhood." When I asked Janet to join the league last year, she rejected the invite by saying "lol no," and then almost immediately got such intense FOMO that she asked me to bcc her on all the recap emails. And now she's here, writing paragraphs of this stuff. 

***

This week's episode was all about honoring the late Jonathan Gold, a beloved food critic who very effectively communicated the fact that the best food in LA is found in strip malls (if you are in search of more streamable content, might I suggest the fantastic Jonathan Gold/Los Angeles documentary, [City of Gold](https://www.imdb.com/title/tt2614776/ "City of Gold IMDB")?) The cheftestants skipped the Quickfire challenge in favor of eating through said strip malls and being ferried around LA in BMWs (deeply ironic as Jonathan Gold was known for his 1998 Dodge pick-up).

The cuisines featured in this food-porn montage covered everything from Filipino to Szechuan to Indian to Mexican to Thai, a selection that varied almost as much as the cheftestants' levels of judgment and risk taking. **Nini** managed to pull off an Asian/Jewish/Mexican "masa ball soup" that landed her in the top three, while **Steph Cmar** decided that Top Chef All Stars would be a totally great time to try her hand at making Indian food for Padma. Needless to say, the Indian nacho was a no-go. Maybe she should have taken a page out of Nini's book and called it a "naancho"?

At least Steph went out of her comfort zone. The guests at the Union Station were also privy to two crudos and two tartares (yawn). One of the tartares came from **Melissa King,** who gets a special shoutout from me this week because it turns out that homegirl is from Alhambra, which is right next to my own hometown. After that backstory about having to learn to be proud of being Chinese, I legitimately felt like a race traitor for not putting her first in my rankings. Her tartare also seemed pretty good, even if some misplaced peppers gave Tom's mouth a bit of a burn. Speaking of incredible burns, the other tartare came from **Brian Malarkey** and was so extra that guest judge Ruth Reichl called it "the kind of showoff dish that a lot of people who hate restaurants hate about restaurants." Oof.

But it turns out that Ruth Reichl reserved her most cutting remarks for **Angelo,** whose poor tuna apparently "died in vain." In addition to producing an alternative pronunciation of "turmeric" so confidently said that I questioned the lines between TV and reality and reality TV, Angelo made a really sweet soup that the judges (and **Jen Caroll,** tbh) hated. Angelo packed his knives to face off against **Joe Sasto** in the season's first Last Chance Kitchen episode, and poor sweet Angelo lost out there as well. Pour one out for Angelo. Pour one out for Jonathan Gold. And while we're at it, pour one out for restaurants and especially restaurant workers. 

Finishing off the toasts on a more uplifting note: this week's Elimination Challenge winner goes to **Kevin Gillespie** for making a delicious looking little pork ball (guys I know so much about food) topped with "Granny's" apple butter, which Ruth Reichl implored him to bottle and sell. A feel-good win, especially after that heart-tugging backstory about his recent bout with cancer. When Kevin said "I'm here to prove that I'm still alive," I knew he was either going home or winning the challenge. I, like everyone else who ranked him in their top 8, am glad it was the latter. 

\- Janet

***

**About the Author:** Janet Xu is a Ph.D candidate in the Department of Culinary Anthropology at Princeton University's Gusteau Institute. Her research focuses on the intercultural perceptions of the differences between soups and sauces. She recently published an Op-Ed in the New York Times arguing that cereal is, in fact, soup. In her free time, Janet measures the amount of air included in different bags of chips.

`r include_graphics("Pics/Highlights/Wk2/Janet Face.jpeg", dpi = headshotsize*1.5)`

### Highlights From Around the League

**_Send me pics and highlights (cooking and personal) to include in next week's edition. In other words, send noods!_**

**Chris and Katya** got a shout-out from Padma on Twitter, which is cool. But where are the pics of the actual stew, guys? What the fuck!

```{r, out.width = highlightsize, fig.align="center"}
add_image("Pics/Highlights/Wk2/Chris-Katya Padma Shout-Out.jpg", highlightsize)
```

Not to be a one-upper, but **Janet and Eugene** got a pity Instagram like from Tom last Halloween after they creepily dressed up as him and erstwhile _Last Chance Kitchen_ sponsor Hidden Valley Ranch&reg;. Affirm us, Tom! Pour one out for Hidden Valley Ranch, who's been usurped by BMW this season.

```{r, out.width = highlightsize, fig.align="center"}
add_image("Pics/Highlights/Wk2/Eugene-Janet Tom Instagram.jpg", highlightsize)
add_image("Pics/Highlights/Wk2/Eugene-Janet Tom Instagram2.jpg", highlightsize)
```

**Claire** made a delicious banana bread last week. And big ups to the mysterious goop in the red tupperware, the rhythm instrument to the banana bread's lead guitar. We see you, goop!

```{r, out.width = highlightsize, fig.align="center", dpi = 36}
add_image("Pics/Highlights/Wk2/Claire banana bread.jpeg", highlightsize)
```

For his homework, **Eugene** had to identify "ships" in some satellite images. That sure doesn't look like a ship!

```{r, out.width = highlightsize, fig.align="center", dpi = 36}
add_image("Pics/Highlights/Wk2/ships (allegedly).png", highlightsize)
```

**Sarah** made some awesome dumplings, but more importantly, check out the coaster. I fucking love projections.

```{r, out.width = highlightsize, fig.align="center", dpi = 36}
add_image("Pics/Highlights/Wk2/Sarah dumps.jpeg", highlightsize)
```

**Stephen's** been doing his part to singlehandedly keep the Genesee Brewing Company in business. Who needs a bail-out bill when you've got friends like these?

```{r, out.width = highlightsize, fig.align="center", dpi = 36}
add_image("Pics/Highlights/Wk2/Stephen Cream Ale.png", highlightsize)
```

**Gracie** made a v tasty Burmese chicken noodle dish called _\*reads notes\*_ pasta carbonara. White sauce strikes again!

```{r, out.width = highlightsize, fig.align="center", dpi = 36}
add_image("Pics/Highlights/Wk2/Gracie Burmese Chicken.png", highlightsize)
```

**Jackie** broke quarantine to go join the fools on the beach in Florida. Shame, Jackie, shame!

```{r, out.width = highlightsize, fig.align="center", dpi = 36}
add_image("Pics/Highlights/Wk2/Jackie on Beach.jpeg", highlightsize)
```

**Emily** made some tasty 'dillas. She tells me the thumb was the best part!

```{r, out.width = highlightsize, fig.align="center", dpi = 36}
add_image("Pics/Highlights/Wk2/Emily Quesadillas.jpeg", highlightsize)
```

Lastly, **Natasha** baked two foccacia breads: one with cherry tomatoes & garlic and one with baby freshwater eels! Even stranger than the eels, though, is her pronunciation of foccacia. "foh-coh-shyuh"? come on!

```{r, out.width = highlightsize, fig.align="center", dpi = 36}
add_image("Pics/Highlights/Wk2/Natasha Foccacia.jpeg", highlightsize)
```

Like all Asian men on Twitter, **Eugene** is trying to grow facial hair for the first time. Here's a ~15 day update. In the words of his good friend Milo, who's on a similar endeavor:

```{r, out.width = highlightsize, fig.align="center", dpi = 36}
add_image("Pics/Highlights/Wk2/Milo Tweet.PNG", highlightsize)
add_image("Pics/Highlights/Wk2/Eugene face.jpg", highlightsize)
```

```{r, Week 2 Summary}
#### update these
eliminated <- c(eliminated, "Angelo Sosa")
QFwinner <- c()
QFHM <- c()
EMwinner <- c("Kevin Gillespie")
EMHM <- c("Bryan Voltaggio", "Nini Nguyen")
week <- 2
####


week_point_title <- paste("Week", week, "Points") 
week_winners <- list(QFwinner = QFwinner, 
                     QFHM = QFHM, 
                     EMwinner = EMwinner, 
                     EMHM = EMHM)

weekly_episode_score <- left_join(weekly_episode_score %>% 
                                    dplyr::select(-"Total Episode Points"),
                                  find_weekly_episode_score(),
                                  by = c("Team", "Members")) %>% 
  mutate("Total Episode Points" = rowSums(.[grep("Points", names(.))], na.rm = TRUE)) %>% 
  arrange(desc(`Total Episode Points`)) 

Final_points_lost <- preds_long %>% 
  mutate("Final Ranking Points Lost" = ifelse(Cheftestant %in% eliminated,
                                              abs(16 - match(Cheftestant, eliminated) - `Predicted Finish`),
                                              0)) %>% 
  group_by(Team, Members) %>% 
  dplyr::summarise("Final Ranking Points Lost"= sum(`Final Ranking Points Lost`)) %>%
  ungroup() %>% 
  arrange(`Final Ranking Points Lost`)

current_rankings <- left_join(weekly_episode_score %>% 
                                dplyr::select(Team, Members, `Total Episode Points`),
                              Final_points_lost,
                              by = c("Team", "Members")) %>% 
  mutate("Scaled Episode Points" = ((`Total Episode Points` - min(`Total Episode Points`)) / 
           (max(`Total Episode Points`) - min(`Total Episode Points`))) %>% round(2),
         "Scaled Final Ranking Points" = 1 - ((`Final Ranking Points Lost` - min(`Final Ranking Points Lost`)) /
                                                 (max(`Final Ranking Points Lost`) - min(`Final Ranking Points Lost`))) %>% round(2),
         "Projected Final Score" = ((`Scaled Episode Points` + `Scaled Final Ranking Points`) / 2) %>% round(2)) %>% 
  arrange(desc(`Projected Final Score`)) %>% 
  mutate("Current Standing" = row_number()) %>% 
  dplyr::select(`Current Standing`, Team, Members, `Projected Final Score`, everything())
current_rankings$`Current Standing` <- sapply(current_rankings$`Current Standing`, toOrdinal::toOrdinal)
```

### Current Standings

After 2 weeks, here are the current standings. This counts everyone's earned Episode Scores and projects Ranking Scores based on who's been eliminated.


```{r}
current_rankings %>%
  kable(format = "html", escape = FALSE, align = "l") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "responsive"),
                fixed_thead = TRUE,
                font_size = 12,
                position = "left",
                full_width = TRUE) %>%
  column_spec(1:4,
              bold = TRUE,
              color = "black",
              background = "lightgray",
              width = "20em") %>%
  column_spec(4,
              border_right = TRUE) %>%
  scroll_box(height = "700px")
```

### Quickfire

There was no Quickfire this week! What a concept!

### Elimination Challenge

**Winner:** Kevin!

[`r ji("chef")`]{.emoji} [`r ji("trophy")`]{.emoji}

`r include_graphics(c(kevin), dpi = headshotsize)`

**Honorable Mentions:** Bryan and Nini were runners-up.

[`r ji("chef")`]{.emoji} [`r ji("2nd_place_medal")`]{.emoji}

`r include_graphics(c(bryan, nini), dpi = headshotsize)`

**Eliminated:** Angelo

[`r ji("skull_and_crossbones")`]{.emoji}

`r include_graphics(c(angelo), dpi = headshotsize)`

**Winning Dishes**

```{r, out.width = dishsize}
add_image("https://i.imgur.com/xhdo9r1.png", dishsize)
```

```{r, out.width = dishsize}
add_image("https://i.imgur.com/AsTOpbQ.png", dishsize)
```

```{r, out.width = dishsize}
add_image("https://i.imgur.com/wcqEGUH.png", dishsize)
```

**Losing Dish**

```{r, out.width = dishsize}
add_image("https://i.imgur.com/9O9vxou.png", dishsize)
```

### Episode Score

The top 3 scorers in points for this episode are **`r arrange(weekly_episode_score, desc(weekly_episode_score$"Week 2 Points")) %>% slice(1) %>% pull(Team)`**, **`r arrange(weekly_episode_score, desc(weekly_episode_score$"Week 2 Points")) %>% slice(2) %>% pull(Team)`**, and **`r arrange(weekly_episode_score, desc(weekly_episode_score$"Week 2 Points")) %>% slice(3) %>% pull(Team)`**.

Here are the overall standings in Episode Score after the second episode.

```{r, fig.height = 6}
ggplot(weekly_episode_score,
       aes(x = reorder(Team, weekly_episode_score$"Total Episode Points"),
           y = weekly_episode_score$`Total Episode Points`)) +
  geom_bar(stat = "identity",
           position = "dodge",
           aes(fill = Team)) +
  scale_fill_discrete(guide = FALSE) +
  scale_x_discrete(labels = function(x) str_wrap(x, width = 30)) +
  coord_flip() +
  theme_bw() +
  labs(x = "Team",
       y = "Total Episode Points",
       title = paste("Overall Episode Score Standings After Week", week),
       subtitle = "A higher score is better!")
```

### Ranking Score

We won't know the final Ranking Scores until the season is over, but we can get a sense of how people are doing based on where they ranked contestants that have already been eliminated (notwithstanding possible Last Chance Kitchen comebacks).

Here's where things stand currently.

```{r, fig.height = 6}
ggplot(Final_points_lost,
       aes(x = reorder(Team, -Final_points_lost$"Final Ranking Points Lost"),
           y = Final_points_lost$`Final Ranking Points Lost`)) +
  geom_bar(stat = "identity",
           position = "dodge",
           aes(fill = Team)) +
  scale_fill_discrete(guide = FALSE) +
  scale_x_discrete(labels = function(x) str_wrap(x, width = 30)) +
  coord_flip() +
  theme_bw() +
  labs(x = "Team",
       y = "Total Points",
       title = paste("Total Final Ranking Points Lost as of Week", week),
       subtitle = "A lower number is better!")
```

### Team Breakdowns

Lastly, here's a look at how everyone's team is doing after Week 2.

```{r}
preds_wide %>% 
  mutate_if(is.character,
            function(x) {
              cell_spec(x,
                        format = "html",
                        color = ifelse(x %in% eliminated, "red", ""),
                        strikeout = ifelse(x %in% eliminated, TRUE, FALSE))
            }) %>% 
  kable(format = "html", escape = FALSE) %>% 
  kable_styling(bootstrap_options = c("striped", "hover", "responsive"),
                font_size = 12,
                fixed_thead = TRUE,) %>% 
  column_spec(1, bold = TRUE, 
              width = "10em; display: inline-block;") %>% 
  column_spec(2, border_right = TRUE, width = "20em") %>% 
  scroll_box(width = "100%",
             height = "700px")

```

# References

### How to Watch!

Episodes air on Bravo every Thursday at 10pm EST. You can watch live on [Bravo's website](https://www.bravotv.com/ "Bravo TV") at that time or on-demand the next morning with a cable TV login. If you don't have a login, email the league; I'm sure someone can provide one.

The season is also available for purchase on Amazon and iTunes, but again, check with others in the league for a TV login so you can watch for free.

You can find episodes of _Last Chance Kitchen_ on [YouTube](https://www.youtube.com/playlist?list=PL-nJHoTivBRRUMIWQIUEaqe3As46Qd3Q0 "Last Kance Chicken") (scroll to the bottom).

### Cheftestants

<style type="text/css">
.table {

    width: 40%;
    vertical-align: middle;
}
</style>

Bios for each chef can be found [here](https://www.bravotv.com/top-chef/about).

Thank you to [\@lynnandtonic](https://twitter.com/lynnandtonic "Lynn Fisher") for the headshots!

|Name           |Headshot                                              |Status                                   |
|---------------|:----------------------------------------------------:|:---------------------------------------:|
Eric Adjepong   |`r include_graphics(c(eric), dpi = headshotsize)`     |[`r ji("chef")`]{.emoji2}                |
Karen Akunowicz |`r include_graphics(c(karen), dpi = headshotsize)`    |[`r ji("chef")`]{.emoji2}                |
Jennifer Carroll|`r include_graphics(c(jen), dpi = headshotsize)`      |[`r ji("chef")`]{.emoji2}                |
Stephanie Cmar  |`r include_graphics(c(stephanie), dpi = headshotsize)`|[`r ji("chef")`]{.emoji2}                |
Lisa Fernandes  |`r include_graphics(c(lisa), dpi = headshotsize)`     |[`r ji("chef")`]{.emoji2}                |
Kevin Gillespie |`r include_graphics(c(kevin), dpi = headshotsize)`    |[`r ji("chef")`]{.emoji2}                |
Gregory Gourdet |`r include_graphics(c(gregory), dpi = headshotsize)`  |[`r ji("chef")`]{.emoji2}                |
Melissa King    |`r include_graphics(c(melissa), dpi = headshotsize)`  |[`r ji("chef")`]{.emoji2}                |
Jamie Lynch     |`r include_graphics(c(jamie), dpi = headshotsize)`    |[`r ji("chef")`]{.emoji2}                |
Brian Malarkey  |`r include_graphics(c(brian), dpi = headshotsize)`    |[`r ji("chef")`]{.emoji2}                |
Nini Nguyen     |`r include_graphics(c(nini), dpi = headshotsize)`     |[`r ji("chef")`]{.emoji2}                |
Joe Sasto       |`r include_graphics(c(joe), dpi = headshotsize)`      |[`r ji("skull_and_crossbones")`]{.emoji2}|
Angelo Sosa     |`r include_graphics(c(angelo), dpi = headshotsize)`   |[`r ji("skull_and_crossbones")`]{.emoji2}|
Bryan Voltaggio |`r include_graphics(c(bryan), dpi = headshotsize)`    |[`r ji("chef")`]{.emoji2}                |
Lee Anne Wong   |`r include_graphics(c(lee_anne), dpi = headshotsize)` |[`r ji("chef")`]{.emoji2}                |

### Rules

**Scoring:** The goal of the season is to have the highest **Final Score**. 2nd place gets **\$15**, and the winner gets **\$105** (24 total players!).  Your score will have two parts, each weighted equally:

* **Ranking Score:** This is how closely your predictions match up with the final finishes. If you guess every chef's finish from 1-to-16 correctly, you would have a perfect score.
    - Note that chefs eliminated early in the season may get back onto the show via Last Chance Kitchen! In that case, we will use the chef's final position after the season has ended. 
    - To clarify, a chef's final position is their position after being eliminated from the _main_ show. That is, it doesn't matter how well a chef does on Last Chance Kitchen unless they make it back onto the main competition.

* **Episode Score:** You'll score points for every chef in your **top 8** (MySpace, baby) that ends up on top in the quickfire or elimination challenge.
    - Points Awarded = 
        - Quickfire Winner: 
        $\scriptsize (10 - ChefRank) * 2$
        - Elimination Challenge Winner: 
        $\scriptsize (15 - ChefRank) * 2$
        - Quickfire or Elimination Challenge Honorable Mentions: 
        $\scriptsize 10 - ChefRank$
      
   - *Honorable Mentions: being in the Top 3, being on the winning team for team challenges, or getting a special shout out from the judges.
   - Chefs eliminated during an episode can still earn points from winning a quickfire that episode.
   - If there is no one winner specified in a team challenge, everyone receives honorable mention points.
        

    - Example:  I rank Eric as 2nd overall and Jenn as 3rd overall.  Eric wins the quickfire and Jenn is on top in the elimination challenge.  I get 9 points from Eric (11 - 2) and 12 points from Jenn ((9 - 3) * 2).

At the end, we'll scale everyone's points (see below) for the two scores.  Your final score will be the average of the two. 

* **Final Score:**
  - Scaled Final Ranking Score = 
  $$\scriptsize 1 - \frac{YourRankingScore - min(AllRankingScores)}{max(AllRankingScores) - min(AllRankingScores)}$$
  - Scaled Episode Score = 
  $$\scriptsize \frac{YourEpisodeScore - min(AllEpisodeScores)}{max(AllEpisodeScores) - min(AllEpisodeScores)}$$
  - **Final Score** = 
  $$\scriptsize \frac{Scaled Ranking Score + Scaled Episode Score}{2}$$

### Have You Paid?

Everyone's paid!

```{r}
players <- c("Jackson",
             "Natasha",
             "Sarah",
             "Janet",
             "Jackie",
             "Kate",
             "Claire",
             "Tobin",
             "Emma",
             "Amie",
             "Eugene",
             "Emily / Stephen",
             "Sherry",
             "Jane / Kelsey",
             "Katya",
             "Chris",
             "Jia / Joyce",
             "Hilary / Sam",
             "Elsa",
             "Gracie",
             "Ada",
             "Tiffany / Steven",
             "Divya",
             "Maddy")

paid <- c("Emily / Stephen",
          "Tobin",
          "Claire",
          "Natasha",
          "Sarah",
          "Amie",
          "Elsa",
          "Jackie",
          "Jia / Joyce",
          "Janet",
          "Eugene",
          "Jane / Kelsey",
          "Divya",
          "Hilary / Sam",
          "Ada",
          "Kate",
          "Maddy",
          "Sherry",
          "Emma",
          "Jackson",
          "Tiffany / Steven",
          "Gracie",
          "Katya",
          "Chris")

paid_table <- as.tibble(players) %>% 
  rename(Players = value) %>% 
  mutate(Paid = ifelse(Players %in% paid, "Yes", "No")) %>% 
  mutate(Paid = cell_spec(Paid, "html", background = ifelse(Players %in% paid, "green", "red")))

kable(paid_table, format = "html", escape = FALSE) %>% 
  kable_styling(bootstrap_options = c("striped", "hover", "condensed"),
                full_width = FALSE,
                position = "left",
                fixed_thead = TRUE)
```